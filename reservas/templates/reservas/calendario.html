{% extends 'base.html' %}

{% block content %}
<h2 class="mb-4">Calendario de disponibilidad</h2>

<div class="mb-3">
  <label>Seleccion√° una fecha</label>
  <input type="date" id="fecha" class="form-control">
</div>

<div id="calendario"></div>

<script>
const calendario = document.getElementById('calendario');
const fechaInput = document.getElementById('fecha');

fechaInput.addEventListener('change', () => {
  fetch(`/calendario/?fecha=${fechaInput.value}`)
    .then(res => res.json())
    .then(data => renderCalendario(data));
});

function renderCalendario(data) {
  calendario.innerHTML = '';

  data.canchas.forEach(cancha => {
    const card = document.createElement('div');
    card.className = 'card p-3 mb-3';

    let html = `<h5>${cancha.nombre}</h5><div class="d-flex flex-wrap">`;

    for (let h = 10; h < 22; h++) {
      const hora = `${String(h).padStart(2,'0')}:00`;
      const ocupada = data.ocupadas[cancha.id]?.includes(hora);

      html += `
        <span class="badge m-1 ${ocupada ? 'bg-danger' : 'bg-success'}">
          ${hora}
        </span>
      `;
    }

    html += '</div>';
    card.innerHTML = html;
    calendario.appendChild(card);
  });
}
</script>
{% endblock %}
